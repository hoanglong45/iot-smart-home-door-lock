(this.webpackJsonpdashboard=this.webpackJsonpdashboard||[]).push([[0],{213:function(e,t,n){},214:function(e,t,n){},349:function(e,t,n){},353:function(e,t,n){"use strict";n.r(t);var a=n(8),r=n(0),c=n.n(r),i=n(35),s=n.n(i),o=(n(213),n(51)),l=n(115),d=n(38),u=n(355),j=n(91),b=(n(214),n(367)),m=n(368),f=n(369),O=n(123),p=n(124),h=n(142),x=n(141),y=n(356),g=n(116);g.a.initializeApp({apiKey:"AIzaSyCfTKQ-5sDNvN3QfC6S4oqeKOnbEv7AxzE",authDomain:"iot-smart-home-door-lock-7ccc9.firebaseapp.com",databaseURL:"https://iot-smart-home-door-lock-7ccc9.firebaseio.com",projectId:"iot-smart-home-door-lock-7ccc9",storageBucket:"iot-smart-home-door-lock-7ccc9.appspot.com",messagingSenderId:"513607106040",appId:"1:513607106040:web:d627644390357454e76a0d"});var v=g.a.database(),I=(g.a.storage(),g.a.auth()),w=function(e){Object(h.a)(n,e);var t=Object(x.a)(n);function n(){var e;Object(O.a)(this,n);for(var a=arguments.length,r=new Array(a),c=0;c<a;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={users:[]},e}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=this;v.ref("Access").on("value",(function(t){var n=t.val(),a=[];for(var r in n)a.unshift({id:r,name:n[r].name,rfid:n[r].rfid,accessDate:n[r].access_by_date,accessTime:n[r].access_by_time});e.setState({users:a})}))}},{key:"render",value:function(){var e=this.state.users;return Object(a.jsx)("div",{children:Object(a.jsx)(y.a,{dataSource:e,columns:[{title:"Name",dataIndex:"name"},{title:"RFID",dataIndex:"rfid"},{title:"Access by Date",dataIndex:"accessDate"},{title:"Access by Time",dataIndex:"accessTime"}],rowKey:"id"})})}}]),n}(c.a.Component),C=n(72),k=n.n(C),S=n(198),F=n(101),D=n(54),_=n(203),N=n(357),P=n(359),T=n(205),A=n(360),L=n(47),U=n(361),E=n(362),q=n(363),K=n(364),z=n(365),R=n(366),V=function(e){Object(h.a)(n,e);var t=Object(x.a)(n);function n(){return Object(O.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props,t=e.users,n=e.editableCell,r=e.mergedColumns,c=e.handleCancel;return Object(a.jsx)("div",{children:Object(a.jsx)(y.a,{components:{body:{cell:n}},bordered:!0,dataSource:t,columns:r,rowClassName:"editable-row",pagination:{onChange:c},rowKey:"id"})})}}]),n}(c.a.Component),B=n(204),H=n(358),$=function(e){var t=e.rfid,n=Object(r.useState)(""),c=Object(o.a)(n,2),i=c[0],s=c[1];return Object(r.useEffect)((function(){function e(){return(e=Object(F.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://localhost:5000/api/capture/".concat(t));case 2:n=e.sent,console.log("res",n),s((function(e){return n.url}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(t){e.apply(this,arguments)}(t)}),[]),Object(a.jsx)("div",{className:"container-camera-component",children:Object(a.jsx)("img",{src:i,alt:"test",style:{width:"100%"}})})},J={display:"flex",justifyContent:"space-between",alignItems:"center"},Q=function(e){var t=Object(r.useState)(!1),n=Object(o.a)(t,2),c=n[0],i=n[1],s=Object(r.useState)(1),l=Object(o.a)(s,2),d=l[0],u=l[1],j=Object(r.useState)(null),b=Object(o.a)(j,2),m=b[0],f=b[1],O=N.a.useForm(),p=Object(o.a)(O,1)[0],h=e.arrUsers,x=function(){p.resetFields()},y=function(e){var t=e.rfid;t&&!function(e){for(var t in h)if(e===h[t].rfid)return!0;return!1}(t)?(u(d+1),f(e)):B.b.error("RFID existed !")};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsxs)(H.a,{title:"Add new user",visible:c,onCancel:function(){u(1),x(),i(!1)},footer:!1,children:[function(e){switch(e){case 1:return Object(a.jsxs)(N.a,{form:p,name:"basic",initialValues:{remember:!0},onFinish:y,children:[Object(a.jsx)(N.a.Item,{label:"Name",name:"name",rules:[{required:!0,message:"Please input your name"}],children:Object(a.jsx)(P.a,{})}),Object(a.jsx)(N.a.Item,{label:"RFID",name:"rfid",rules:[{required:!0,message:"Please input your RFID",pattern:/^[0-9]+$/}],children:Object(a.jsx)(P.a.Password,{type:"number"})}),Object(a.jsx)(N.a.Item,{label:"Pin",name:"pin",rules:[{required:!0,message:"Please input your pin",pattern:/^[0-9]+$/}],children:Object(a.jsx)(P.a.Password,{})}),Object(a.jsx)(N.a.Item,{children:Object(a.jsx)(L.a,{type:"primary",htmlType:"submit",children:"Next step"})})]});case 2:return Object(a.jsxs)(a.Fragment,{children:[" ",m&&Object(a.jsx)($,{rfid:m.rfid})," "]});default:return null}}(d),d>1&&Object(a.jsxs)("div",{style:J,children:[Object(a.jsx)(L.a,{type:"primary",onClick:function(){u(d-1)},children:"Prev step"}),Object(a.jsx)(L.a,{type:"primary",onClick:function(){var e=v.ref("Users"),t={name:m.name,rfid:m.rfid,pin:m.pin,created_by_date:(new Date).toLocaleDateString(),created_by_time:(new Date).toLocaleTimeString()};e.push(t);try{fetch("http://localhost:5000/api/training").then((function(e){return console.log("res",e)}))}catch(n){console.log("err",n)}finally{i(!1),x()}},children:"Submit"})]})]}),Object(a.jsx)(L.a,{type:"primary",onClick:function(){u(1),x(),i(!0)},children:"Add User"})]})},M=function(e){var t=e.editing,n=e.dataIndex,r=e.title,c=e.inputType,i=(e.record,e.index,e.children),s=Object(_.a)(e,["editing","dataIndex","title","inputType","record","index","children"]);return Object(a.jsx)("td",Object(D.a)(Object(D.a)({},s),{},{children:t?Object(a.jsx)(N.a.Item,{name:n,style:{margin:0},rules:[{required:!0,message:"Please Input ".concat(r,"! ").concat("number"===c?"requirement number":""),pattern:"number"===c&&/^[0-9]+$/}],children:Object(a.jsx)(P.a,{})}):i}))},W=function(){var e=N.a.useForm(),t=Object(o.a)(e,1)[0],n=Object(r.useState)(""),c=Object(o.a)(n,2),i=c[0],s=c[1],l=Object(r.useState)(""),d=Object(o.a)(l,2),u=d[0],j=d[1];Object(r.useEffect)((function(){v.ref("Users").on("value",(function(e){var t=e.val(),n=[];for(var a in t)n.push({avatarUrl:t[a].avatarUrl,id:a,name:t[a].name,rfid:t[a].rfid,pin:t[a].pin,createdDate:t[a].created_by_date,createdTime:t[a].created_by_time});s(n)}))}),[]);var b=function(e){return e.id===u},m=function(){j("")},f=function(e){switch(e){case"success":T.a[e]({message:"Success",description:"Updated successfully"});break;case"error":T.a[e]({message:"Error",description:"RFID existed !"})}},O=function(){var e=Object(F.a)(k.a.mark((function e(n){var a,r,c,o,l,d,u,b;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=v.ref("Users/".concat(n)),r=Object(S.a)(i),c=function(e){for(var t in r)if(e===r[t].rfid)return!0;return!1},e.prev=3,e.next=6,t.validateFields();case 6:o=e.sent,(l=r.findIndex((function(e){return n===e.id})))>-1?(d=r[l],u=d.createdDate,b=d.createdTime,c(o.rfid)?f("error"):(f("success"),r.splice(l,1,Object(D.a)(Object(D.a)({},d),o)),a.set(Object(D.a)(Object(D.a)({},o),{},{created_by_date:u,created_by_time:b})),s(r),j(""))):(r.push(o),s(r),j("")),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),console.log("Validate Failed:",e.t0);case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(t){return e.apply(this,arguments)}}(),p=function(e){return{filterDropdown:function(t){var n=t.setSelectedKeys,r=t.selectedKeys,c=t.confirm,i=t.clearFilters;return Object(a.jsxs)("div",{style:{padding:8},children:[Object(a.jsx)(P.a,{ref:function(e){return e},placeholder:"Search ".concat(e),value:r[0],onChange:function(e){return n(e.target.value?[e.target.value]:[])},onPressEnter:function(){return h(r,c,e)},style:{width:188,marginBottom:8,display:"block"}}),Object(a.jsxs)(A.b,{children:[Object(a.jsx)(L.a,{type:"primary",onClick:function(){return h(r,c,e)},icon:Object(a.jsx)(E.a,{}),size:"small",style:{width:90},children:"Search"}),Object(a.jsx)(L.a,{onClick:function(){return x(i)},size:"small",style:{width:90},children:"Reset"})]})]})},filterIcon:function(e){return Object(a.jsx)(E.a,{style:{color:e?"#1890ff":void 0}})},onFilter:function(t,n){return n[e]?n[e].toString().toLowerCase().includes(t.toLowerCase()):""},onFilterDropdownVisibleChange:function(e){return e},render:function(e){return e}}},h=function(e,t,n){t()},x=function(e){e()},y=[{title:"avatar",dataIndex:"avatarUrl",render:function(e){return Object(a.jsx)("img",{style:{width:"100px",height:"100px",objectFit:"cover"},alt:e,src:e})}},Object(D.a)(Object(D.a)({title:"name",dataIndex:"name"},p("name")),{},{editable:!0}),Object(D.a)(Object(D.a)({title:"rfid",dataIndex:"rfid"},p("rfid")),{},{editable:!0}),{title:"pin",dataIndex:"pin",editable:!0},{title:"Created by Date",dataIndex:"createdDate"},{title:"Created by Time",dataIndex:"createdTime"},{title:"operation",dataIndex:"operation",render:function(e,n){return b(n)?Object(a.jsxs)(A.b,{size:"middle",children:[Object(a.jsxs)(L.a,{onClick:function(){return O(n.id)},children:["Save",Object(a.jsx)(q.a,{})]}),Object(a.jsx)(U.a,{title:"Sure to cancel?",onConfirm:m,children:Object(a.jsxs)(L.a,{children:["Cancel ",Object(a.jsx)(K.a,{})]})})]}):Object(a.jsxs)(A.b,{size:"middle",children:[Object(a.jsxs)(L.a,{disabled:""!==u,onClick:function(){return function(e){t.setFieldsValue(Object(D.a)({name:"",rfid:"",pin:""},e)),j(e.id)}(n)},children:["Edit",Object(a.jsx)(z.a,{style:{marginLeft:"5px"}})]}),Object(a.jsx)(U.a,{title:"Sure to delete?",onConfirm:function(){return g(n.id)},children:Object(a.jsxs)(L.a,{disabled:""!==u,children:[Object(a.jsx)("span",{children:"Delete"}),Object(a.jsx)(R.a,{})]})})]})}}],g=function(e){v.ref("Users/".concat(e)).remove()},I=y.map((function(e){return e.editable?Object(D.a)(Object(D.a)({},e),{},{onCell:function(t){return{record:t,inputType:"rfid"===e.dataIndex||"pin"===e.dataIndex?"number":"text",dataIndex:e.dataIndex,title:e.title,editing:b(t)}}}):e}));return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(Q,{arrUsers:i}),Object(a.jsx)(N.a,{form:t,component:!1,children:Object(a.jsx)(V,{users:i,editableCell:M,mergedColumns:I,handleCancel:m})})]})},G=(n(349),function(e){var t=Object(r.useState)(""),n=Object(o.a)(t,2),c=n[0],i=n[1],s=Object(d.f)(),l=e.setIsLogin;return Object(a.jsx)("div",{className:"container-form",children:Object(a.jsxs)(N.a,{name:"basic",initialValues:{remember:!0},onFinish:function(e){!function(e,t){I.signInWithEmailAndPassword(e,t).then(function(){var e=Object(F.a)(k.a.mark((function e(t){var n;return k.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object.entries(t.user)[5][1].b.h;case 2:if(!(n=e.sent)){e.next=7;break}return l(!0),localStorage.setItem("token",n),e.abrupt("return",s.push("/access-log"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){i("Email or password incorrect !")}))}(e.email,e.password)},onFinishFailed:function(e){console.log("Failed",e)},className:"form",children:[Object(a.jsx)("h1",{children:"login"}),Object(a.jsx)(N.a.Item,{label:"Email",name:"email",rules:[{required:!0,message:"Please input your email!"}],children:Object(a.jsx)(P.a,{})}),Object(a.jsx)(N.a.Item,{label:"Password",name:"password",rules:[{required:!0,message:"Please input your password!"}],children:Object(a.jsx)(P.a.Password,{})}),Object(a.jsx)(N.a.Item,{children:Object(a.jsx)(L.a,{type:"primary",htmlType:"submit",children:"Login"})}),c&&Object(a.jsx)(N.a.Item,{className:"error",children:c})]})})}),X=u.a.Header,Y=u.a.Content,Z=u.a.Footer,ee=u.a.Sider,te=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),n=t[0],c=t[1],i=Object(r.useState)((function(){return!!localStorage.getItem("token")})),s=Object(o.a)(i,2),O=s[0],p=s[1];return Object(a.jsx)(l.a,{children:O?Object(a.jsxs)(u.a,{style:{minHeight:"100vh"},children:[Object(a.jsxs)(ee,{collapsible:!0,collapsed:n,onCollapse:function(){c(!n)},children:[Object(a.jsx)("div",{className:"logo"}),Object(a.jsxs)(j.a,{theme:"dark",defaultSelectedKeys:["/access-log"],mode:"inline",children:[Object(a.jsxs)(j.a.Item,{icon:Object(a.jsx)(b.a,{}),children:["Access Log",Object(a.jsx)(l.b,{to:"/access-log"})]},"/access-log"),Object(a.jsxs)(j.a.Item,{icon:Object(a.jsx)(m.a,{}),children:["User Information",Object(a.jsx)(l.b,{to:"/user-info"})]},"/user-info"),Object(a.jsx)("div",{className:"button-logout"}),Object(a.jsx)(j.a.Item,{icon:Object(a.jsx)(f.a,{}),children:Object(a.jsx)("button",{style:{background:"none",border:"none",cursor:"pointer",width:"calc(100% - 32px)",padding:"0",textAlign:"left"},onClick:function(){I.signOut().then((function(){localStorage.removeItem("token"),p(!1)})),window.location.replace("/iot-smart-home-door-lock-client")},children:"Logout"})})]})]}),Object(a.jsxs)(u.a,{className:"site-layout",children:[Object(a.jsx)(X,{className:"site-layout-background",style:{padding:0}}),Object(a.jsx)(Y,{style:{margin:"0 16px"},children:Object(a.jsxs)(d.c,{children:[Object(a.jsx)(d.a,{exact:!0,path:"/user-info",component:W}),Object(a.jsx)(d.a,{exact:!0,path:"/access-log",component:w})]})}),Object(a.jsx)(Z,{style:{textAlign:"center"},children:"Dashboard \xa92020 Created by Long Le Hoang"})]})]}):Object(a.jsx)(G,{setIsLogin:p})})};s.a.render(Object(a.jsx)(te,{}),document.getElementById("root"))}},[[353,1,2]]]);
//# sourceMappingURL=main.fd27b079.chunk.js.map